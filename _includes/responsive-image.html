{% comment %}
Responsive Image Component
Parameters:
- name: image filename without extension (required)
- alt_key: key for alt text in site.data.content.images.alt_text (required)
- class: CSS classes for the img element (optional)
- container_class: CSS classes for the container div (optional)
- delay: animation delay value (optional)
- child_class: additional child animation classes (optional)
- loading: loading attribute value (optional, defaults to lazy)
- ring: whether to add ring overlay (optional, defaults to true)
- ring_class: border radius class for ring (optional, defaults to rounded-xl)
{% endcomment %}

{% assign delay_class = '' %}
{% if include.delay %}
  {% assign delay_class = 'child ![--delay:' | append: include.delay | append: 's]' %}
{% endif %}

{% if include.child_class %}
  {% assign delay_class = delay_class | append: ' ' | append: include.child_class %}
{% endif %}

{% assign loading_attr = include.loading | default: 'lazy' %}
{% assign show_ring = include.ring | default: true %}
{% assign ring_radius = include.ring_class | default: 'rounded-xl' %}

<div class="{{ include.container_class }} {{ delay_class }}">
  <picture>
    <!-- AVIF sources with responsive widths -->
    {% if include.name == 'fellowship-conversation' or include.name == 'fellowship-play' %}
      <source srcset="
        {{ '/assets/images/' | append: include.name | append: '-960w.avif' | relative_url }} 960w,
        {{ '/assets/images/' | append: include.name | append: '-1184w.avif' | relative_url }} 1184w
      " type="image/avif">
    {% elsif include.name == 'prayer-communal-1' or include.name == 'prayer-family-1' or include.name == 'prayer-family-2' or include.name == 'prayer-teaching' %}
      <source srcset="{{ '/assets/images/' | append: include.name | append: '-384w.avif' | relative_url }}" type="image/avif">
    {% else %}
      <source srcset="{{ '/assets/images/' | append: include.name | append: '-768w.avif' | relative_url }}" type="image/avif">
    {% endif %}

    <!-- WebP sources with responsive widths -->
    {% if include.name == 'fellowship-conversation' or include.name == 'fellowship-play' %}
      <source srcset="
        {{ '/assets/images/' | append: include.name | append: '-960w.webp' | relative_url }} 960w,
        {{ '/assets/images/' | append: include.name | append: '-1184w.webp' | relative_url }} 1184w
      " type="image/webp">
    {% elsif include.name == 'prayer-communal-1' or include.name == 'prayer-family-1' or include.name == 'prayer-family-2' or include.name == 'prayer-teaching' %}
      <source srcset="{{ '/assets/images/' | append: include.name | append: '-384w.webp' | relative_url }}" type="image/webp">
    {% else %}
      <source srcset="{{ '/assets/images/' | append: include.name | append: '-768w.webp' | relative_url }}" type="image/webp">
    {% endif %}

    <!-- JPG fallback with responsive widths -->
    {% if include.name == 'fellowship-conversation' or include.name == 'fellowship-play' %}
      <img
        srcset="
          {{ '/assets/images/' | append: include.name | append: '-960w.jpg' | relative_url }} 960w,
          {{ '/assets/images/' | append: include.name | append: '-1184w.jpg' | relative_url }} 1184w
        "
        src="{{ '/assets/images/' | append: include.name | append: '-1184w.jpg' | relative_url }}"
        alt="{{ site.data.content.images.alt_text[include.alt_key] }}"
        class="{{ include.class }}"
        loading="{{ loading_attr }}"
      />
    {% elsif include.name == 'prayer-communal-1' or include.name == 'prayer-family-1' or include.name == 'prayer-family-2' or include.name == 'prayer-teaching' %}
      <img
        src="{{ '/assets/images/' | append: include.name | append: '-384w.jpg' | relative_url }}"
        alt="{{ site.data.content.images.alt_text[include.alt_key] }}"
        class="{{ include.class }}"
        loading="{{ loading_attr }}"
      />
    {% else %}
      <img
        src="{{ '/assets/images/' | append: include.name | append: '-768w.jpg' | relative_url }}"
        alt="{{ site.data.content.images.alt_text[include.alt_key] }}"
        class="{{ include.class }}"
        loading="{{ loading_attr }}"
      />
    {% endif %}
  </picture>
  {% if show_ring %}
    <div class="absolute inset-0 {{ ring_radius }} ring-1 ring-inset pointer-events-none ring-stone-900/10 dark:ring-white/10"></div>
  {% endif %}
</div>